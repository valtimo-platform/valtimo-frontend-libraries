<!--
  ~ Copyright 2015-2020 Ritense BV, the Netherlands.
  ~
  ~ Licensed under EUPL, Version 1.2 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ https://joinup.ec.europa.eu/collection/eupl/eupl-text-eupl-12
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" basis,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<ul class="sidebar-elements">
  <ng-container *ngFor="let menuItem of menuItems">
    <li
      [class.parent]="menuItem.children"
      [hidden]="!menuItem.show"
      [routerLinkActive]="'active'"
      [routerLinkActiveOptions]="{exact: true}"
      [ngClass]="{
        'menu-item--hidden': menuItem.includeFunction !== undefined,
        'menu-item--visible':
          menuItem.includeFunction !== undefined &&
          (includeFunctionObservables[menuItem.title] | async)
      }"
    >
      <a *ngIf="menuItem.link" [routerLink]="menuItem.link" class="sub-item">
        <valtimo-menu-item-text [menuItem]="menuItem"></valtimo-menu-item-text>
      </a>
      <a *ngIf="!menuItem.link" class="sub-item">
        <valtimo-menu-item-text [menuItem]="menuItem"></valtimo-menu-item-text>
      </a>
      <ng-container *ngIf="menuItem.children">
        <ul class="sub-menu">
          <li class="title">{{ menuItem.title | translate }}</li>
          <li
            *ngFor="let subMenuItem of menuItem.children"
            [routerLinkActive]="'active'"
            [routerLinkActiveOptions]="{exact: true}"
          >
            <a *ngIf="subMenuItem.link" [routerLink]="subMenuItem.link">
              <valtimo-submenu-item-text [submenuItem]="subMenuItem"></valtimo-submenu-item-text>
            </a>
            <a *ngIf="!subMenuItem.link">
              <valtimo-submenu-item-text [submenuItem]="subMenuItem"></valtimo-submenu-item-text>
            </a>
          </li>
        </ul>
      </ng-container>
    </li>
  </ng-container>
</ul>
